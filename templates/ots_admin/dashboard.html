{% extends 'main.html' %}

{% block title %}Admin Dashboard - OTS{% endblock %}

{% block top %}
<a href="/home"><i class="fas fa-home"></i> Home</a>
<a href="/admin/"><i class="fas fa-toolbox"></i> Django Admin</a>
<a href="/admin/OTS/testconfig/"><i class="fas fa-clock"></i> Test Config</a>
<a href="/admin/OTS/question/"><i class="fas fa-question-circle"></i> Questions</a>
<a href="/admin/OTS/candidate/"><i class="fas fa-users-cog"></i> Candidates</a>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
  <div class="welcome-card" style="margin-bottom:2rem;">
    <i class="fas fa-tachometer-alt"></i>
    <h1>Admin Dashboard</h1>
    <p>Manage the Online Testing System and view key metrics</p>
  </div>

  <div class="grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.25rem;margin-bottom:2rem;">
    <div class="action-card">
      <i class="fas fa-users"></i>
      <h3>Total Candidates</h3>
      <p class="text-2xl" style="font-size:1.75rem;font-weight:800;">{{ stats.total_candidates }}</p>
    </div>
    <div class="action-card">
      <i class="fas fa-list-ul"></i>
      <h3>Total Questions</h3>
      <p class="text-2xl" style="font-size:1.75rem;font-weight:800;">{{ stats.total_questions }}</p>
    </div>
    <div class="action-card">
      <i class="fas fa-file-alt"></i>
      <h3>Total Tests</h3>
      <p class="text-2xl" style="font-size:1.75rem;font-weight:800;">{{ stats.total_results }}</p>
    </div>
    <div class="action-card">
      <i class="fas fa-star"></i>
      <h3>Average Points</h3>
      <p class="text-2xl" style="font-size:1.75rem;font-weight:800;">{{ stats.avg_points }}</p>
    </div>
  </div>

  <div class="summary-card">
    <div class="summary-content">
      <p>Quick Actions</p>
    </div>
    <div class="summary-stats" style="gap:1rem;">
      <a href="/admin/" class="action-btn"><i class="fas fa-toolbox"></i> Open Django Admin</a>
      <a href="/admin/OTS/testconfig/" class="action-btn"><i class="fas fa-clock"></i> Configure Timer Rules</a>
      <a href="/admin/OTS/question/" class="action-btn"><i class="fas fa-question-circle"></i> Manage Questions</a>
      <a href="/admin/OTS/candidate/" class="action-btn"><i class="fas fa-users-cog"></i> Manage Candidates</a>
    </div>
  </div>

  <div class="history-table-container">
    <h3 style="margin-bottom:12px;">Latest Results</h3>
    {% if latest_results %}
    <table class="history-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Candidate</th>
          <th>Date</th>
          <th>Time</th>
          <th>Attempt</th>
          <th>Right</th>
          <th>Wrong</th>
          <th>Points</th>
          <th>Review</th>
        </tr>
      </thead>
      <tbody>
        {% for r in latest_results %}
        <tr>
          <td>{{ r.resultid }}</td>
          <td>{{ r.username.name }}</td>
          <td>{{ r.date }}</td>
          <td>{{ r.time }}</td>
          <td>{{ r.attempt }}</td>
          <td class="correct">{{ r.right }}</td>
          <td class="wrong">{{ r.wrong }}</td>
          <td class="points">{{ r.points|floatformat:2 }}</td>
          <td><a class="test-btn" href="{% url 'OTS:testDetail' %}?resultid={{ r.resultid }}">Open</a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
      <div class="action-card"><i class="fas fa-info-circle"></i><p>No results yet.</p></div>
    {% endif %}
  </div>
</div>
{% endblock %}
